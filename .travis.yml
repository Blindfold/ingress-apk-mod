language: python
python:
  - "3.2"
jdk:
  - oraclejdk7
env:
 global:
  - "ARTIFACTS_AWS_REGION=eu-west-1"
  - "ARTIFACTS_S3_BUCKET=ingress-apk-mod"
  - secure: "qZ+iOQF75UxSghFC2cQpGUBfSTu/Hvny9ek2Wim/2/xrSVtK8X/kY4poQ05iS2TNmC5R0GTegYpf1p0Wz65NCfIk+UcjJQ4Xu5wF3GnH9ZmxhOPdnMR54TiDSLkJifWc7DtcgaxP+6HcZLQXHM2i2bWV3Bdjc8kQueOMPorp//I="
  - secure: "hsI8TzN1l+X75kKe6qcu+6rLAsU3l2rzdDrArVGK08Wtm8Gm8Zp3fdLYgSzoIFOzWQguiRDOA0UVzK1PMSC/SASkgvc/ssCRTtb9lxlMxm7htPF03TRiUltOrm4iqMcy68Rwoe4lsmttFZDkuwpred5d40oN+qzk5auUA0CxTiI="
before_install:
  - sudo apt-get update -qq
  - if [ `uname -m` = x86_64 ]; then sudo apt-get install -qq --force-yes libgd2-xpm ia32-libs ia32-libs-multiarch; fi
  - wget -O android-sdk-linux.tgz http://dl.google.com/android/android-sdk_r22.2.1-linux.tgz
  - tar -zxf android-sdk-linux.tgz
  - export ANDROID_HOME=`pwd`/android-sdk-linux
  - export PATH=${PATH}:${ANDROID_HOME}/tools:${ANDROID_HOME}/platform-tools:${ANDROID_HOME}/build-tools/17.0.0/:${ANDROID_HOME}/tools/proguard/bin/
  - echo y | android update sdk --filter android-17,platform-tools,build-tools-17.0.0 --all --no-ui --force
  - wget http://ingress-apk-mod.o4kapuk.info/files/lib.tar.gz
  - tar xvfz lib.tar.gz
  - wget http://dekanszn.ru/ingress-latest.apk
install:
  - pip install -r requirements.txt --use-mirrors
before_script:
  - "gem install travis-artifacts"
script:
  - git config --global user.email ""
  - git config --global user.name "Ingress apk mod"
  - python bin/import_apk.py ingress-latest.apk
  - python bin/release.py
after_success:
  - "travis-artifacts upload --path ingress-latest-broot-*.apk --target-path builds"
  - "travis-artifacts upload --path ingress-latest-broot-*-mute.apk --target-path builds"
notifications:
  email:
    on_success: never
